<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="pt-br" xml:lang="pt-br">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta content="public" name="security" />
<meta content="index,follow" name="Robots" />
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta content="reference" name="DC.Type" />
<meta name="DC.Title" content="Instruções preparadas e colunas de fluxo" />
<meta content="Requisições setXXXStream, Colunas de fluxo, como parâmetros IN em instruções preparadas" name="DC.subject" />
<meta content="Requisições setXXXStream, Colunas de fluxo, como parâmetros IN em instruções preparadas" name="keywords" />
<meta scheme="URI" name="DC.Relation" content="rrefjdbc29874.html" />
<meta content="XHTML" name="DC.Format" />
<meta content="rrefjavsqlprst" name="DC.Identifier" />
<meta content="pt-br" name="DC.Language" />
<link href="commonltr.css" type="text/css" rel="stylesheet" />
<title>Instruções preparadas e colunas de fluxo</title>
</head>
<body id="rrefjavsqlprst"><a name="rrefjavsqlprst"><!-- --></a>


<h1 class="topictitle1">Instruções preparadas e colunas de fluxo</h1>


<div>
<div class="section">
<p>As requisições <em>setXXXStream</em> realizam um fluxo de dados entre o
aplicativo e o banco de dados.</p>

</div>

<div class="section">
<p>O JDBC permite que o parâmetro IN seja definido como um fluxo de entrada do
Java para passagem de uma grande quantidade de dados em frações menores.
Quando a instrução é executada, o <em>driver</em> de JDBC faz chamadas repetidas
a este fluxo de entrada, lendo seu conteúdo e transmitindo este conteúdo como
dados do parâmetro.</p>

</div>

<div class="section">
<div class="p">

O <span>Derby</span>
suporta os três tipos de fluxo fornecidos pelo JDBC 1.2.
Estes três fluxos são:
<ul>
<li><em>setBinaryStream</em>

<p>para fluxos contendo bytes não interpretados</p>

</li>

<li><em><span />setAsciiStream</em>
<p>para fluxos contendo caracteres ASCII</p>
</li>

<li><em><span />
<span />
setUnicodeStream</em>
<p>para fluxos contendo caracteres Unicode</p>
</li>

</ul>

</div>

</div>

<div class="section">
<p>

O JDBC requer que seja especificado o comprimento do fluxo.
O objeto de fluxo passado para estes três métodos pode ser tanto um
objeto de fluxo Java padrão, quanto uma subclasse própria do usuário que
implementa a interface <em>java.io.InputStream</em> padrão.</p>

</div>

<div class="section">
<div class="p">De acordo com o padrão JDBC, os fluxos somente podem ser armazenados em
colunas dos tipos de dado mostrados na tabela
<a href="rrefjavsqlprst.html#rrefjavsqlprst__jdbc25312">Tipos de dado JDBC que permitem fluxo</a>.
Os fluxos não podem ser armazenados em colunas de outros tipos de dado nativos,
ou em tipos de dado definidos pelo usuário.

<div class="tablenoborder"><a name="rrefjavsqlprst__jdbc25312"><!-- --></a><table summary="" cellspacing="0" cellpadding="4" id="rrefjavsqlprst__jdbc25312" frame="void" border="1" rules="all"><caption>Tabela 1. Tipos de dado JDBC que permitem fluxo</caption>





<thead align="left">
<tr>
<th valign="top" width="22.68041237113402%" id="N10148">Valores da coluna</th>

<th valign="top" width="22.68041237113402%" id="N1014F">Tipo correspondente</th>

<th valign="top" width="15.463917525773196%" id="N10156">AsciiStream</th>

<th valign="top" width="18.556701030927837%" id="N1015D">UnicodeStream</th>

<th valign="top" width="20.618556701030926%" id="N10164">BinaryStream</th>

</tr>

</thead>

<tbody>
<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">CLOB</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">java.sql.Clob</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">&nbsp;</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">CHAR</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">&nbsp;</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">VARCHAR</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">&nbsp;</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">LONGVARCHAR</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">X</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">X</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">&nbsp;</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">BINARY</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">x</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">BLOB</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">java.sql.Blob</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">x</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">VARBINARY</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">x</td>

</tr>

<tr>
<td valign="top" width="22.68041237113402%" headers="N10148 ">LONGVARBINARY</td>

<td valign="top" width="22.68041237113402%" headers="N1014F ">&nbsp;</td>

<td valign="top" width="15.463917525773196%" headers="N10156 ">x</td>

<td valign="top" width="18.556701030927837%" headers="N1015D ">x</td>

<td valign="top" width="20.618556701030926%" headers="N10164 ">X</td>

</tr>

</tbody>

</table>
</div>

</div>

</div>

<div class="section">
<div class="p">O X maiúsculo indica o tipo de dado de destino preferido para o tipo de
fluxo (Consulte <a href="rrefjdbc20377.html#rrefjdbc20377__jdbc31241">Mapeamento de java.sql.Types em tipos SQL</a>.)
<div class="note"><span class="notetitle">Nota: </span>Se o fluxo for armazenado em uma coluna de um tipo que não seja
LONG VARCHAR ou LONG VARCHAR FOR BIT DATA, deverá ser possível que todo o
fluxo caiba na memória de uma só vez.
Os fluxos armazenados em colunas LONG VARCHAR e LONG VARCHAR FOR BIT DATA
não possuem esta limitação.</div>
</div>

</div>

<div class="section">
<div class="p">O exemplo a seguir mostra como o usuário pode armazenar
<em>java.io.File</em> em uma coluna LONG VARCHAR usando fluxo:
<pre><strong>Statement s = conn.createStatement();
s.executeUpdate("CREATE TABLE minha_tabela (a INT, b LONG VARCHAR)");
conn.commit();
java.io.File arquivo = new java.io.File("derby.txt");
int comprArquivo = (int) arquivo.length();
<strong>// primeiro, criar o fluxo de entrada</strong>
java.io.InputStream fluxoEntrada = new java.io.FileInputStream(arquivo);
PreparedStatement ps = conn.prepareStatement(
    "INSERT INTO minha_tabela VALUES (?, ?)");
ps.setInt(1, 1);
<strong>// definir o valor do parâmetro de entrada como sendo o fluxo de entrada</strong>
ps.setAsciiStream(2, fluxoEntrada, comprArquivo);
ps.execute();
conn.commit();</strong>
</pre>

</div>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>Tópico pai:</strong> <a href="rrefjdbc29874.html" title="">java.sql.PreparedStatement</a></div>
</div>
</div>

</body>
</html>